@*  page router là on-init -> link trên header  *@
@page "/on-init"
@inject HttpClient _http
@using System.Net.Http.Json
@using System.Text.Json
<div class="container">
    <h3>Lifecycle - On Init</h3>
    <p>Demo về các hàm khởi tạo trong Blazor</p>
    <button class="btn btn-primary" @onclick="LoadData">Tải dữ liệu</button>
    <br>
    <div class="row">
        @foreach(var item in ls){
        <div class="col-4">
            <div class="card text-start">
                <img class="card-img-top" src="https://dummyimage.com/600x400/000/fff" alt="Title" />
                <div class="card-body">
                    <h4 class="card-title">Title</h4>
                    <p class="card-text">Body</p>
                </div>
            </div>
            
        </div>
        }
    </div>
</div>
@code{
    List<ProductApiVM> ls = new List<ProductApiVM>();

    public async Task LoadData(){
        Console.WriteLine("Load data");
        // lấy dự liệu từ web ai của 1 server khác 
        // dùng httpclient
        List<ProductApiVM> data = await _http.GetFromJsonAsync<List<ProductApiVM>>("https://svcy.myclass.vn/api/ProductApi/getall");
        Console.WriteLine(JsonSerializer.Serialize(data));
        ls=data;

    }
}
